@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Profile";
}

<div class="container-fluid py-4">
    <div class="card shadow-sm rounded-4 p-4 position-relative">

        <h4 class="fw-bold mb-4">Administrator Profile</h4>

        <!-- PROFILE PIC -->
        <div class="profile-pic-wrapper mb-4 text-center">
            <img id="adminProfileImg" src="~/images/ctu-logo.png" class="rounded-circle shadow-sm"
                 style="width:120px; height:120px; object-fit:cover;" />
            <input type="file" id="profilePicInput" class="d-none" accept="image/*"
                   onchange="previewImage(this,'adminProfileImg')" />
            <button class="btn btn-sm btn-outline-primary profile-edit-btn"
                    style="top:0; right:0; font-size:0.75rem; padding:2px 6px;"
                    id="editProfilePicBtn">
                Edit
            </button>
        </div>

        <!-- BANNER -->
        <div class="banner-wrapper mb-4 text-center">
            <img id="adminBannerImg" src="~/images/banner-placeholder.jpg" class="rounded shadow-sm"
                 style="width:100%; height:150px; object-fit:cover;" />
            <input type="file" id="bannerInput" class="d-none" accept="image/*"
                   onchange="previewImage(this,'adminBannerImg')" />
            <button class="btn btn-sm btn-outline-primary profile-edit-btn"
                    style="top:0; right:0; font-size:0.75rem; padding:2px 6px;"
                    id="editBannerBtn">
                Edit
            </button>
        </div>

        <!-- INFO TABLE -->
        <div class="position-relative">
            <!-- EDIT BUTTON TOP RIGHT -->
            <button class="btn btn-primary btn-sm position-absolute"
                    style="top:0; right:0;" id="editAdminInfoBtn">
                <i class="bi bi-pencil"></i> Edit
            </button>

            <table class="table mb-0" id="adminInfoTable" style="border:none; margin-top:1.5rem;">
                <tbody>
                    <tr><td class="fw-semibold text-muted" style="width:30%;">Full Name</td><td>Administrator</td></tr>
                    <tr><td class="fw-semibold text-muted">Email</td><td>admin@ctu.edu.ph</td></tr>
                    <tr><td class="fw-semibold text-muted">Contact</td><td>0912-345-6789</td></tr>
                    <tr><td class="fw-semibold text-muted">Address</td><td>Balamban, Cebu</td></tr>
                    <tr><td class="fw-semibold text-muted">Employee ID</td><td>CTU-ADMIN-001</td></tr>
                    <tr><td class="fw-semibold text-muted">Department</td><td>CTU Balamban Campus</td></tr>
                    <tr><td class="fw-semibold text-muted">Position</td><td>System Administrator</td></tr>
                    <tr><td class="fw-semibold text-muted">Date Joined</td><td>May 12, 2021</td></tr>
                    <tr><td class="fw-semibold text-muted">Username</td><td>admin01</td></tr>
                    <tr><td class="fw-semibold text-muted">Last Login</td><td>November 12, 2025 - 8:42 AM</td></tr>
                    <tr><td class="fw-semibold text-muted">Status</td><td><span class="badge bg-success">Active</span></td></tr>
                </tbody>
            </table>

            <!-- SAVE BUTTON BOTTOM RIGHT -->
            <div class="text-end mt-3">
                <button class="btn btn-success d-none" id="saveAdminInfoBtn">Save</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // ===================== IMAGE PREVIEW =====================
        function previewImage(input,imgId){
            const file=input.files[0];
            if(file){
                const reader=new FileReader();
                reader.onload=e=>document.getElementById(imgId).src=e.target.result;
                reader.readAsDataURL(file);
            }
        }

        document.getElementById("editProfilePicBtn").addEventListener("click",
            ()=>document.getElementById("profilePicInput").click());
        document.getElementById("editBannerBtn").addEventListener("click",
            ()=>document.getElementById("bannerInput").click());

        // ===================== ADMIN INFO EDIT =====================
        const editAdminInfoBtn=document.getElementById("editAdminInfoBtn");
        const saveAdminInfoBtn=document.getElementById("saveAdminInfoBtn");

        editAdminInfoBtn.addEventListener("click", ()=>{
            const table=document.getElementById("adminInfoTable");
            const cells=table.querySelectorAll("td:not(:first-child)");
            cells.forEach(td=>td.setAttribute("contenteditable","true"));
            saveAdminInfoBtn.classList.remove('d-none');
            editAdminInfoBtn.classList.add('d-none');
        });

        saveAdminInfoBtn.addEventListener("click", ()=>{
            const table=document.getElementById("adminInfoTable");
            const cells=table.querySelectorAll("td:not(:first-child)");
            cells.forEach(td=>td.removeAttribute("contenteditable"));
            saveAdminInfoBtn.classList.add('d-none');
            editAdminInfoBtn.classList.remove('d-none');
            alert("Changes saved (frontend only).");
        });
    </script>
}
