@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Profile";
}

<div class="container-fluid py-4">
    <div class="card shadow-sm rounded-4 p-4 d-flex flex-column" style="height: 80vh; max-height: 800px;">
        <h4 class="fw-bold mb-4">Administrator Profile</h4>

        <!-- PROFILE PIC -->
        <div class="mb-4 pb-2 text-center">
            <img id="adminProfileImg" src="~/images/ctu-logo.png" class="rounded-circle shadow-sm"
                 style="width:130px; height:130px; object-fit:cover;" />
            <input type="file" id="profilePicInput" class="d-none" accept="image/*"
                   onchange="previewImage(this,'adminProfileImg')" />
            <button class="btn btn-sm btn-outline-primary mt-2" id="editProfilePicBtn">
                <i class="bi bi-pencil"></i> Edit
            </button>
        </div>

        <!-- BANNER -->
        <div class="mb-4 pb-2 text-center">
            <img id="adminBannerImg" src="~/images/banner-placeholder.jpg" class="rounded shadow-sm"
                 style="width:100%; height:180px; object-fit:cover;" />
            <input type="file" id="bannerInput" class="d-none" accept="image/*"
                   onchange="previewImage(this,'adminBannerImg')" />
            <button class="btn btn-sm btn-outline-primary mt-2" id="editBannerBtn">
                <i class="bi bi-pencil"></i> Edit
            </button>
        </div>

        <!-- SCROLLABLE TABLE -->
        <div class="flex-grow-1 overflow-auto mb-3">
            <table class="table table-bordered mb-0" id="adminInfoTable">
                <tbody>
                    <tr><td class="fw-semibold text-muted" style="width:30%;">Full Name</td><td>Administrator</td></tr>
                    <tr><td class="fw-semibold text-muted">Email</td><td>admin@ctu.edu.ph</td></tr>
                    <tr><td class="fw-semibold text-muted">Contact</td><td>0912-345-6789</td></tr>
                    <tr><td class="fw-semibold text-muted">Address</td><td>Balamban, Cebu</td></tr>
                    <tr><td class="fw-semibold text-muted">Employee ID</td><td>CTU-ADMIN-001</td></tr>
                    <tr><td class="fw-semibold text-muted">Department</td><td>CTU Balamban Campus</td></tr>
                    <tr><td class="fw-semibold text-muted">Position</td><td>System Administrator</td></tr>
                    <tr><td class="fw-semibold text-muted">Date Joined</td><td>May 12, 2021</td></tr>
                    <tr><td class="fw-semibold text-muted">Username</td><td>admin01</td></tr>
                    <tr><td class="fw-semibold text-muted">Last Login</td><td>November 12, 2025 - 8:42 AM</td></tr>
                    <tr><td class="fw-semibold text-muted">Status</td><td><span class="badge bg-success">Active</span></td></tr>
                </tbody>
            </table>
        </div>

        <!-- BUTTONS FIXED AT BOTTOM-RIGHT -->
        <div class="d-flex justify-content-end gap-2">
            <button class="btn btn-primary" id="editAdminInfoBtn"><i class="bi bi-pencil"></i> Edit</button>
            <button class="btn btn-success d-none" id="saveAdminInfoBtn">Save</button>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // ===================== IMAGE PREVIEW =====================
        function previewImage(input,imgId){
            const file=input.files[0];
            if(file){
                const reader=new FileReader();
                reader.onload=e=>document.getElementById(imgId).src=e.target.result;
                reader.readAsDataURL(file);
            }
        }

        document.getElementById("editProfilePicBtn").addEventListener("click",
            ()=>document.getElementById("profilePicInput").click());
        document.getElementById("editBannerBtn").addEventListener("click",
            ()=>document.getElementById("bannerInput").click());

        // ===================== ADMIN INFO EDIT =====================
        const editAdminInfoBtn=document.getElementById("editAdminInfoBtn");
        const saveAdminInfoBtn=document.getElementById("saveAdminInfoBtn");
        editAdminInfoBtn.addEventListener("click", ()=>{
            const table=document.getElementById("adminInfoTable");
            const cells=table.querySelectorAll("td:not(:first-child)");
            cells.forEach(td=>td.setAttribute("contenteditable","true"));
            saveAdminInfoBtn.classList.remove('d-none');
            editAdminInfoBtn.classList.add('d-none');
        });
        saveAdminInfoBtn.addEventListener("click", ()=>{
            const table=document.getElementById("adminInfoTable");
            const cells=table.querySelectorAll("td:not(:first-child)");
            cells.forEach(td=>td.removeAttribute("contenteditable"));
            saveAdminInfoBtn.classList.add('d-none');
            editAdminInfoBtn.classList.remove('d-none');
            alert("Changes saved (frontend only).");
        });
    </script>
}
